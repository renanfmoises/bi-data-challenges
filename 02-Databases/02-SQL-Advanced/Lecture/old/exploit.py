import sqlite3

conn = sqlite3.connect("data/exploitable_db.sqlite")
c = conn.cursor()


def connect(username, password):
    query = f"""
                SELECT *
                FROM users
                WHERE users.username = '{username}'
                AND users.password = '{password}'
            """

    c.execute(query)
    user = c.fetchone()
    if user is None:
        return "Unauthorized"
    return "Authorized"


# print(connect("john", "wrong_password"))
# print(connect("john", "passw0rd"))

print(connect("john", "'OR 1 = 1 --"))
